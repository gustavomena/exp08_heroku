<!DOCTYPE html>
<link rel="stylesheet" href="/bootstrap/bootstrap.css"/>
<link rel="stylesheet" href="/public/style.css">
<script src="/BootstrapJs/bootstrap.js"></script>
<body>

  <body>
    <div class="card bg-dark text-center">
        <div class="card-body">
            <form action="/Validate">
            <h5 class="card-title text-center">Por favor, ingresar los datos del nuevo usuario:</h5>
            <div class="row d-flex align-items-center mb-1">
                <div class="col-12">Username:</div>
                <div class="col-7 m-auto"><input type="text" name="username" class="form-control" required/></div>
            </div>
            <div class="row d-flex align-items-center">
                <div class="col-12">Password:</div>
                <div class="col-7 m-auto"><input type="password" name="password" class="form-control" required/></div>
            </div>
            <div class="row d-flex align-items-center">
                <div class="col-12">e-Mail:</div>
                <div class="col-7 m-auto"><input type="email" name="email" class="form-control" required/></div>
            </div>
            <div class="row d-flex align-items-center">
                <div class="col-12">Tipo de usuario:</div>
                <div class="col-7 m-auto">
                    <select class="form-select" name="tipo">
                        <option style="display:none" selected></option>
                        <option value="Admin">Administrador</option>
                        <option value="User">Usuario</option>
                    </select>
                </div>
            </div>
            <button class="btn bg-light my-3">Ingresar</button>
            </form>
    </div>
</div>

<style>
    body{
        background-color: #5e1010;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        height: 60vh;
    }
    div{
        color: white;
    }
</style>

<script>
    const form = document.querySelector('form');

    form.addEventListener('submit', (e) =>{
        e.preventDefault();
        const username = document.querySelector('input[name=username]').value;
        const password = document.querySelector('input[name=password]').value;
        const email = document.querySelector('input[name=email]').value;
        const tipo = document.querySelector('select[name=tipo]').value;

        const url = '/create-user';
        const data = {
            username,
            password,
            email,
            tipo,
        };

        fetch(url, {
            method: 'POST',
            body: JSON.stringify(data),
            headers: {
                'Content-Type': 'application/json'
            }
        })
            .then(res => {
                if(res.status === 200){
                    alert('Usuario creado con Ã©xito');
                    window.location.href = '/Inicio';
                }
            })
            .catch(err => console.log(err));
            });

</script>

</body>
</html>